---
import { pickBoolean, pickString } from '../lib/props';
import { renderKatex } from '../lib/katex';

export interface Props {
  equation?: string;
  expr?: string;
  formula?: string;
  display?: boolean;
  block?: boolean;
}

const props = Astro.props as Record<string, unknown>;
const equation = pickString(props, ['equation', 'expr', 'formula']);
const display = pickBoolean(props, ['display', 'block'], false);
const rendered = renderKatex(equation, display);
---

{display ? (
  <div
    class="bf-katex my-2 overflow-x-auto"
    data-bf-katex
    data-display="true"
    data-equation={equation}
    data-rendered={rendered ? 'true' : undefined}
  >
    {rendered ? <Fragment set:html={rendered} /> : equation}
  </div>
) : (
  <span
    class="bf-katex"
    data-bf-katex
    data-display="false"
    data-equation={equation}
    data-rendered={rendered ? 'true' : undefined}
  >
    {rendered ? <Fragment set:html={rendered} /> : equation}
  </span>
)}
