---
import { t } from '../../lib/i18n';
import BlowfishHomeRecent from './BlowfishHomeRecent.astro';
import type { BlowfishHomepageConfig, BlowfishRecentArticle } from '../../types/homepage';

export interface Props {
  config: BlowfishHomepageConfig;
  articles?: BlowfishRecentArticle[];
  contentHtml?: string;
}

const { config, articles = [], contentHtml = '' } = Astro.props;
const heroImage = config.homepageImage || config.image || '';
const avatar = config.image || config.homepageImage;
---

<article class="max-w-full prose dark:prose-invert">
  <div class="relative">
    <div class="absolute inset-x-0 bottom-0 h-1/2"></div>
    <div class="mx-auto max-w-7xl p-0">
      <div class="relative overflow-hidden rounded-2xl shadow-xl sm:overflow-hidden">
        <div class="absolute inset-0">
          {heroImage && <img src={heroImage} alt="" class="mt-0 mr-0 mb-0 ml-0 h-full w-full object-cover nozoom" />}
          <div class="absolute inset-0 bg-gradient-to-r from-primary-500 to-secondary-600 mix-blend-multiply dark:from-primary-600 dark:to-secondary-800"></div>
        </div>
        <div class="relative flex flex-col items-center justify-center px-4 py-16 text-center sm:px-6 sm:py-24 lg:px-8 lg:py-32">
          {avatar && (
            <img
              class="mb-2 h-36 w-36 rounded-full border border-neutral-100/70 object-cover"
              src={avatar}
              alt={config.imageAlt || config.title || t('components.author_image_alt')}
            />
          )}
          <h1 class="mb-2 text-4xl font-extrabold text-neutral-200">{config.title || t('author.default_name')}</h1>
          {config.subtitle && <h2 class="mb-0 mt-0 text-xl text-neutral-300">{config.subtitle}</h2>}
          {config.links && config.links.length > 0 && (
            <div class="mt-3 mb-10 flex flex-wrap text-2xl">
              {config.links.map((link) => (
                <a class="px-1 text-primary-300 hover:text-primary-400" href={link.href} target="_blank" rel="noopener noreferrer">
                  {link.label}
                </a>
              ))}
            </div>
          )}
          <section class="prose prose-invert w-full">
            {contentHtml ? <div set:html={contentHtml} /> : config.description ? <p>{config.description}</p> : <slot />}
          </section>
        </div>
      </div>
    </div>
  </div>
</article>

{config.showRecent && (
  <BlowfishHomeRecent
    articles={articles}
    limit={config.recentLimit || 4}
    cardView={Boolean(config.cardView)}
    showMoreLink={config.showMoreLink}
    heading={t('shortcode.recent_articles')}
  />
)}
