---
import { t } from '../../lib/i18n';
import type { BlowfishRecentArticle } from '../../types/homepage';

export interface Props {
  articles?: BlowfishRecentArticle[];
  limit?: number;
  cardView?: boolean;
  showMoreLink?: string;
  heading?: string;
}

const { articles = [], limit = 5, cardView = false, showMoreLink, heading = t('shortcode.recent_articles') } = Astro.props;
const items = articles.slice(0, limit);
---

{items.length > 0 && (
  <section class="mt-8">
    <h2 class="mb-10 text-2xl font-extrabold">{heading}</h2>

    {cardView ? (
      <section class="grid w-full gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {items.map((article) => (
          <article class="overflow-hidden rounded-md border border-neutral-200 shadow-sm dark:border-neutral-700">
            {article.thumbnail && (
              <a href={article.href} aria-label={article.title}>
                <img src={article.thumbnail} alt="" class="mt-0 mb-0 h-44 w-full object-cover" loading="lazy" />
              </a>
            )}
            <div class="p-4">
              <h3 class="m-0 text-lg font-semibold leading-snug"><a class="no-underline hover:text-primary-500" href={article.href}>{article.title}</a></h3>
              {article.date && <p class="mt-2 mb-0 text-sm text-neutral-500 dark:text-neutral-400">{article.date}</p>}
              {article.summary && <p class="mt-3 mb-0 text-sm text-neutral-600 dark:text-neutral-400">{article.summary}</p>}
            </div>
          </article>
        ))}
      </section>
    ) : (
      <section class="space-y-10 w-full">
        {items.map((article) => (
          <article class="border-b border-neutral-200 pb-4 dark:border-neutral-700">
            <h3 class="m-0 text-lg font-semibold leading-snug"><a class="no-underline hover:text-primary-500" href={article.href}>{article.title}</a></h3>
            {article.date && <p class="mt-2 mb-0 text-sm text-neutral-500 dark:text-neutral-400">{article.date}</p>}
            {article.summary && <p class="mt-3 mb-0 text-sm text-neutral-600 dark:text-neutral-400">{article.summary}</p>}
          </article>
        ))}
      </section>
    )}

    {showMoreLink && (
      <div class="mt-10 flex justify-center">
        <a href={showMoreLink}>
          <button class="rounded border border-primary-500 bg-transparent px-4 py-2 font-semibold hover:border-transparent hover:text-primary-500">
            {t('recent.show_more')}
          </button>
        </a>
      </div>
    )}
  </section>
)}
