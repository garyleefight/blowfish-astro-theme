---
import { pickArray, pickString } from '../lib/props';

interface Item {
  src?: string;
  image?: string;
  url?: string;
  alt?: string;
  title?: string;
  caption?: string;
}

export interface Props {
  images?: Item[];
  items?: Item[];
}

const props = Astro.props as Record<string, unknown>;
const images = pickArray<Item>(props, ['images', 'items']);
---

<div class="bf-carousel" role="region" aria-label="carousel">
  {images.map((img) => {
    const src = pickString(img as Record<string, unknown>, ['src', 'image', 'url']);
    const alt = pickString(img as Record<string, unknown>, ['alt', 'title', 'caption'], 'slide');
    const caption = pickString(img as Record<string, unknown>, ['caption', 'title']);

    return (
      <figure class="bf-card">
        <img src={src} alt={alt} loading="lazy" />
        {caption && <figcaption>{caption}</figcaption>}
      </figure>
    );
  })}
</div>

<style>
  .bf-carousel { display: flex; gap: 0.8rem; overflow-x: auto; scroll-snap-type: x mandatory; }
  .bf-carousel figure { min-width: min(540px, 90%); margin: 0; scroll-snap-align: start; }
  .bf-carousel img { width: 100%; display: block; aspect-ratio: 16 / 9; object-fit: cover; }
  .bf-carousel figcaption { padding: 0.4rem 0.7rem 0.6rem; color: var(--bf-muted); font-size: 0.8rem; }
</style>
