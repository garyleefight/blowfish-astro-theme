---
import { pickArray, pickString } from '../lib/props';
import { t } from '../lib/i18n';

interface Item {
  src?: string;
  image?: string;
  url?: string;
  alt?: string;
  title?: string;
  caption?: string;
}

export interface Props {
  images?: Item[];
  items?: Item[];
}

const props = Astro.props as Record<string, unknown>;
const images = pickArray<Item>(props, ['images', 'items']);
const normalizedImages = images.map((img) => {
  const record = img as Record<string, unknown>;
  return {
    src: pickString(record, ['src', 'image', 'url']),
    alt: pickString(record, ['alt', 'title', 'caption'], t('components.slide_alt')),
    caption: pickString(record, ['caption', 'title'])
  };
});
---

<div class="flex snap-x snap-mandatory gap-3 overflow-x-auto" role="region" aria-label={t('components.carousel_label')}>
  {normalizedImages.map((img) => (
      <figure class="m-0 min-w-[90%] md:min-w-[540px] snap-start overflow-hidden rounded-md border border-neutral-200 shadow-sm dark:border-neutral-700">
        <img src={img.src} alt={img.alt} loading="lazy" class="mt-0 mb-0 block aspect-video w-full object-cover" />
        {img.caption && <figcaption class="px-3 py-2 text-sm text-neutral-600 dark:text-neutral-400">{img.caption}</figcaption>}
      </figure>
    ))}
</div>
