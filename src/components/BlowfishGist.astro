---
import { pickString } from '../lib/props';
import { t } from '../lib/i18n';

export interface Props {
  id?: string;
  gistId?: string;
  gist?: string;
  url?: string;
  file?: string;
  user?: string;
  username?: string;
}

const props = Astro.props as Record<string, unknown>;
const explicitId = pickString(props, ['id', 'gistId', 'gist']);
const url = pickString(props, ['url']);
const file = pickString(props, ['file']);
const user = pickString(props, ['user', 'username']);

const derivedId = url.match(/gist\.github\.com\/(?:[^/]+\/)?([a-f0-9]+)/i)?.[1] || '';
const id = explicitId || derivedId;
const gistUrl = `https://gist.github.com/${user ? `${user}/` : ''}${id}${file ? `?file=${encodeURIComponent(file)}` : ''}`;
---

<div class="rounded-md border border-neutral-200 p-5 pt-3 shadow-2xl dark:border-neutral-700">
  <p class="m-0 text-lg font-semibold text-neutral-800 dark:text-neutral">{t('components.gist_title')}</p>
  <a class="mt-2 block text-sm text-primary-600 dark:text-primary-400" href={gistUrl} target="_blank" rel="noopener noreferrer">{gistUrl}</a>
</div>
