---
import { pickString } from '../lib/props';

export interface Props {
  id?: string;
  videoId?: string;
  youtube?: string;
  url?: string;
  title?: string;
  label?: string;
}

const props = Astro.props as Record<string, unknown>;
const raw = pickString(props, ['id', 'videoId', 'youtube']);
const url = pickString(props, ['url']);
const parsedFromUrl = url.match(/[?&]v=([A-Za-z0-9_-]{6,})/)?.[1] || url.match(/youtu\.be\/([A-Za-z0-9_-]{6,})/)?.[1] || '';
const id = raw || parsedFromUrl;
const title = pickString(props, ['title', 'label'], 'YouTube video');
const thumbnail = `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
const href = `https://www.youtube.com/watch?v=${id}`;
---

<a class="bf-card bf-yt-lite" href={href} target="_blank" rel="noopener noreferrer" aria-label={title}>
  <img src={thumbnail} alt={title} loading="lazy" />
  <span>Play</span>
</a>

<style>
  .bf-yt-lite { display: block; position: relative; overflow: hidden; }
  .bf-yt-lite img { width: 100%; display: block; aspect-ratio: 16 / 9; object-fit: cover; }
  .bf-yt-lite span {
    position: absolute;
    inset: auto auto 0.7rem 0.7rem;
    background: rgba(0, 0, 0, 0.72);
    color: #fff;
    border-radius: 999px;
    padding: 0.2rem 0.6rem;
    font-size: 0.8rem;
  }
</style>
