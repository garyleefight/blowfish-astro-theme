---
import BlowfishBaseLayout from '../layouts/BlowfishBaseLayout.astro';
import BlowfishBadge from '../components/BlowfishBadge.astro';
import '../styles/theme.css';

const demoPages = [
  { title: 'Homepage Layout', href: '/homepage-layout', description: 'Profile, page, hero, background, card, custom layouts.' },
  { title: 'Hero + Author Partials', href: '/theme/hero', description: 'Mappings for `hero/*` and `author*` partials.' },
  { title: 'List Template', href: '/theme/list', description: '`_default/list.html` parity demo.' },
  { title: 'Single Template', href: '/theme/single', description: '`_default/single.html` with meta/toc/series/related.' },
  { title: 'Term Template', href: '/theme/term', description: '`_default/term.html` parity demo.' },
  { title: 'Terms Template', href: '/theme/terms', description: '`_default/terms.html` parity demo.' },
  { title: 'Search Template', href: '/search', description: 'Fuse.js client search + static index endpoint.' },
  { title: '404 Template', href: '/404.html', description: '`layouts/404.html` parity page.' }
];

const categories = [
  {
    title: 'Shortcodes',
    items: [
      'BlowfishAccordion', 'BlowfishAccordionItem', 'BlowfishAlert', 'BlowfishArticle', 'BlowfishBadge',
      'BlowfishButton', 'BlowfishCarousel', 'BlowfishChart', 'BlowfishCodeberg', 'BlowfishCodeImporter',
      'BlowfishFigure', 'BlowfishForgejo', 'BlowfishGallery', 'BlowfishGist', 'BlowfishGitHubCard',
      'BlowfishGitea', 'BlowfishGitLab', 'BlowfishHuggingFace', 'BlowfishIcon', 'BlowfishKaTeX',
      'BlowfishKeyword', 'BlowfishKeywordList', 'BlowfishLead', 'BlowfishList', 'BlowfishLTR',
      'BlowfishMdImporter', 'BlowfishMermaid', 'BlowfishRTL', 'BlowfishScreenshot', 'BlowfishSwatches',
      'BlowfishTabs', 'BlowfishTab', 'BlowfishTimeline', 'BlowfishTimelineItem', 'BlowfishTypeIt',
      'BlowfishVideo', 'BlowfishYouTubeLite', 'BlowfishCard', 'BlowfishBlockquote'
    ]
  },
  {
    title: 'Homepage + Hero',
    items: [
      'BlowfishHomepage',
      'BlowfishHomeProfile', 'BlowfishHomePage', 'BlowfishHomeHero', 'BlowfishHomeBackground',
      'BlowfishHomeCard', 'BlowfishHomeCustom', 'BlowfishHomeRecent',
      'BlowfishHeroBasic', 'BlowfishHeroBackground', 'BlowfishHeroBig', 'BlowfishHeroThumbAndBackground'
    ]
  },
  {
    title: 'Article + Meta Partials',
    items: [
      'BlowfishArticleLinkSimple', 'BlowfishArticleLinkCard', 'BlowfishArticleLinkCardRelated',
      'BlowfishArticleMetaBasic', 'BlowfishArticleMetaTaxonomy',
      'BlowfishAuthor', 'BlowfishAuthorLinks', 'BlowfishAuthorExtra',
      'BlowfishToc', 'BlowfishRelated', 'BlowfishSeries', 'BlowfishSharingLinks',
      'BlowfishMetaDate', 'BlowfishMetaDateUpdated', 'BlowfishMetaReadingTime', 'BlowfishMetaWordCount',
      'BlowfishMetaEdit', 'BlowfishMetaViews', 'BlowfishMetaLikes', 'BlowfishMetaLikesButton', 'BlowfishMetaZenMode'
    ]
  },
  {
    title: 'Site Partials + Runtime',
    items: [
      'BlowfishHead', 'BlowfishSchema', 'BlowfishAnalytics',
      'BlowfishHeader', 'BlowfishFooter', 'BlowfishBreadcrumbs', 'BlowfishPagination',
      'BlowfishAppearanceToggle', 'BlowfishRuntime', 'BlowfishScrollTop',
      'BlowfishSiteLayout'
    ]
  }
];

const totalComponents = categories.reduce((acc, category) => acc + category.items.length, 0);
---

<BlowfishBaseLayout title="Blowfish Astro Rewrite Docs" description="Single entrypoint for rewrite demos and component catalog">
  <header class="docs-hero bf-card">
    <h1>Blowfish Astro Rewrite</h1>
    <p class="bf-muted">Documentation-style entrypoint for all rewritten components and template demos.</p>
    <div class="docs-badges">
      <BlowfishBadge text="Static Build" color="success" />
      <BlowfishBadge text="Parity Rewrite" color="primary" />
      <BlowfishBadge text={`${totalComponents} Components Cataloged`} color="warning" />
    </div>
    <p class="docs-links">
      <a href="/search">Search Docs</a>
      <a href="/search-index.json">Search Index JSON</a>
      <a href="/robots.txt">Robots</a>
    </p>
  </header>

  <section class="docs-section bf-card">
    <h2>Demo Routes</h2>
    <div class="docs-grid">
      {demoPages.map((page) => (
        <a class="docs-demo-card" href={page.href}>
          <h3>{page.title}</h3>
          <p>{page.description}</p>
          <code>{page.href}</code>
        </a>
      ))}
    </div>
  </section>

  <section class="docs-section bf-card">
    <h2>Component Catalog</h2>
    {categories.map((category) => (
      <article class="docs-catalog-block">
        <h3>{category.title}</h3>
        <p class="bf-muted">{category.items.length} components</p>
        <div class="docs-tags">
          {category.items.map((item) => (
            <code>{item}</code>
          ))}
        </div>
      </article>
    ))}
  </section>

  <section class="docs-section bf-card">
    <h2>Rewrite Tracking</h2>
    <p>Use these files for continuity and parity status:</p>
    <ul>
      <li><code>docs/PARITY_TRACKER.md</code></li>
      <li><code>CODEX_CONTEXT.md</code></li>
      <li><code>REWRITE_CONFIG.json</code></li>
    </ul>
  </section>
</BlowfishBaseLayout>

<style>
  .docs-hero,
  .docs-section {
    padding: 1rem;
  }

  .docs-hero h1,
  .docs-section h2 {
    margin: 0;
  }

  .docs-badges {
    margin-top: 0.7rem;
    display: flex;
    gap: 0.45rem;
    flex-wrap: wrap;
  }

  .docs-links {
    margin: 0.8rem 0 0;
    display: flex;
    gap: 0.7rem;
    flex-wrap: wrap;
  }

  .docs-links a {
    color: var(--bf-primary);
    text-decoration: none;
  }

  .docs-grid {
    margin-top: 0.8rem;
    display: grid;
    gap: 0.75rem;
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .docs-demo-card {
    display: grid;
    gap: 0.35rem;
    text-decoration: none;
    color: inherit;
    border: 1px solid var(--bf-border);
    border-radius: 0.75rem;
    padding: 0.75rem;
    background: color-mix(in srgb, var(--bf-surface) 85%, black 15%);
  }

  .docs-demo-card h3 {
    margin: 0;
    font-size: 1rem;
  }

  .docs-demo-card p {
    margin: 0;
    color: var(--bf-muted);
    font-size: 0.92rem;
  }

  .docs-demo-card code {
    font-size: 0.8rem;
    color: var(--bf-primary);
  }

  .docs-catalog-block {
    margin-top: 0.9rem;
    padding-top: 0.9rem;
    border-top: 1px solid color-mix(in srgb, var(--bf-border) 70%, transparent);
  }

  .docs-catalog-block h3,
  .docs-catalog-block p {
    margin: 0;
  }

  .docs-tags {
    margin-top: 0.6rem;
    display: flex;
    gap: 0.4rem;
    flex-wrap: wrap;
  }

  .docs-tags code {
    border: 1px solid var(--bf-border);
    border-radius: 999px;
    padding: 0.15rem 0.5rem;
    font-size: 0.78rem;
    background: color-mix(in srgb, var(--bf-surface) 85%, black 15%);
  }

  ul {
    margin: 0.6rem 0 0;
    padding-left: 1rem;
  }

  @media (max-width: 760px) {
    .docs-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
